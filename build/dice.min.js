dice={version:"0.5.0",roll:function(h,g){var u=dice.parse.parse(h);return dice.eval.eval(u,g)},stringify_expression:function(h){var g=dice.stringify(h.expression);h=h.op[0];"p"===h&&(h="");return h+"( "+g+" )"},stringify_op:function(h){var g=dice.stringify(h.rightSide),u=dice.stringify(h.leftSide);return g+" "+h.op+" "+u},stringify_rolls:function(h){return h.x+h.mode+(1<h.min?h.min+"..":"")+h.max+":["+h.rolls.join(", ")+"]"},stringify:function(h){return h.expression?dice.stringify_expression(h):h.op?
dice.stringify_op(h):h.rolls?dice.stringify_rolls(h):h.toString()}};
dice.parse=function(){function h(g,h,f,e,m,w){this.message=g;this.expected=h;this.found=f;this.offset=e;this.line=m;this.column=w;this.name="SyntaxError"}(function(g,h){function f(){this.constructor=g}f.prototype=h.prototype;g.prototype=new f})(h,Error);return{SyntaxError:h,parse:function(g){function u(a){if(x!==a){x>a&&(x=0,C={line:1,column:1,seenCR:!1});var b=C,c,d;for(c=x;c<a;c++)d=g.charAt(c),"\n"===d?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===d||"\u2028"===d||"\u2029"===d?(b.line++,b.column=
1,b.seenCR=!0):(b.column++,b.seenCR=!1);x=a}return C}function f(a){c<z||(c>z&&(z=c,D=[]),D.push(a))}function e(){return m()}function m(){var a,b,q,f;a=c;b=r();b!==d?(q=p(),q!==d?(f=t(),f!==d?a=b={op:q,args:[b,f]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=b=t(),a===d&&(a=b=w()));return a}function w(){var a,b,q;a=c;40===g.charCodeAt(c)?(b=T,c++):(b=d,0===n&&f(U));b!==d?(b=s(),b!==d?(b=m(),b!==d?(q=s(),q!==d?(41===g.charCodeAt(c)?(q=V,c++):(q=d,0===n&&f(W)),q!==d?a=b={op:"paren_express",args:[b]}:(c=
a,a=k)):(c=a,a=k)):(c=a,a=k)):(c=a,a=k)):(c=a,a=k);return a}function l(){var a,b;a=c;b=s();b!==d?(42===g.charCodeAt(c)?(b=X,c++):(b=d,0===n&&f(Y)),b!==d?(b=s(),b!==d?a="*":(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=c,b=s(),b!==d?(47===g.charCodeAt(c)?(b=Z,c++):(b=d,0===n&&f($)),b!==d?(b=s(),b!==d?a="/":(c=a,a=k)):(c=a,a=k)):(c=a,a=k));return a}function r(){var a,b,q,f;a=c;b=E();b!==d?(q=l(),q!==d?(f=r(),f!==d?a=b={op:q,args:[b,f]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=c,b=w(),b!==d?(q=l(),q!==
d?(f=r(),f!==d?a=b={op:q,args:[b,f]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k),a===d&&(a=b=E(),a===d&&(a=b=w())));return a}function t(){var a,b,f,e;a=c;b=r();b!==d?(f=p(),f!==d?(e=t(),e!==d?a=b={op:f,args:[b,e]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=b=r(),a===d&&(a=b=w()));return a}function p(){var a,b;a=c;b=s();b!==d?(43===g.charCodeAt(c)?(b=aa,c++):(b=d,0===n&&f(ba)),b!==d?(b=s(),b!==d?a="+":(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=c,b=s(),b!==d?(45===g.charCodeAt(c)?(b=F,c++):(b=d,0===n&&f(G)),b!==
d?(b=s(),b!==d?a="-":(c=a,a=k)):(c=a,a=k)):(c=a,a=k));return a}function E(){var a,b,f,e;a=c;b=y();b!==d?(f=H(),f!==d?(e=I(),e!==d?a=b={op:f,args:[b,e]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k);a===d&&(a=c,b=H(),b!==d?(f=I(),f!==d?a=b={op:b,args:[1,f]}:(c=a,a=k)):(c=a,a=k),a===d&&(b=J(),b!==d&&(b={op:"d",args:[{op:"static",value:1},b]}),a=b,a===d&&(a=b=y())));return a}function H(){var a;100===g.charCodeAt(c)?(a=ca,c++):(a=d,0===n&&f(da));a===d&&(119===g.charCodeAt(c)?(a=ea,c++):(a=d,0===n&&f(fa)));return a}
function I(){var a;a=J();a===d&&(a=y(),a!==d&&(a={op:"random",args:[{op:"static",args:[],value:1},a]}));return a}function J(){var a,b,e;a=c;b=y();b!==d?(g.substr(c,2)===K?(e=K,c+=2):(e=d,0===n&&f(ga)),e!==d?(e=y(),e!==d?a=b={op:"random",args:[b,e]}:(c=a,a=k)):(c=a,a=k)):(c=a,a=k);return a}function s(){var a,b;a=[];L.test(g.charAt(c))?(b=g.charAt(c),c++):(b=d,0===n&&f(M));for(;b!==d;)a.push(b),L.test(g.charAt(c))?(b=g.charAt(c),c++):(b=d,0===n&&f(M));return a}function y(){var a,b,e;n++;e=[];A.test(g.charAt(c))?
(b=g.charAt(c),c++):(b=d,0===n&&f(B));if(b!==d)for(;b!==d;)e.push(b),A.test(g.charAt(c))?(b=g.charAt(c),c++):(b=d,0===n&&f(B));else e=k;e!==d&&(e=parseInt(e.join(""),10));a=e;if(a===d)if(a=c,45===g.charCodeAt(c)?(e=F,c++):(e=d,0===n&&f(G)),e!==d){b=[];A.test(g.charAt(c))?(e=g.charAt(c),c++):(e=d,0===n&&f(B));if(e!==d)for(;e!==d;)b.push(e),A.test(g.charAt(c))?(e=g.charAt(c),c++):(e=d,0===n&&f(B));else b=k;b!==d?a=e=-1*parseInt(b.join(""),10):(c=a,a=k)}else c=a,a=k;n--;a===d&&0===n&&f(ha);b=a;b!==d&&
(b={op:"static",value:b});a=b;a===d&&(a=b=N(),a===d&&(a=c,b=O(),b!==d?(e=N(),e!==d?a=b={op:b,args:[e]}:(c=a,a=k)):(c=a,a=k),a===d&&(a=c,b=O(),b!==d?(e=w(),e!==d?a=b={op:b,args:e.args}:(c=a,a=k)):(c=a,a=k))));return a}function O(){var a;102===g.charCodeAt(c)?(a=ia,c++):(a=d,0===n&&f(ja));a!==d&&(a="floor");a===d&&(114===g.charCodeAt(c)?(a=ka,c++):(a=d,0===n&&f(la)),a!==d&&(a="round"),a===d&&(99===g.charCodeAt(c)?(a=ma,c++):(a=d,0===n&&f(na)),a!==d&&(a="ceil")));return a}function N(){var a,b,e;a=c;
91===g.charCodeAt(c)?(b=oa,c++):(b=d,0===n&&f(pa));if(b!==d){b=[];P.test(g.charAt(c))?(e=g.charAt(c),c++):(e=d,0===n&&f(Q));if(e!==d)for(;e!==d;)b.push(e),P.test(g.charAt(c))?(e=g.charAt(c),c++):(e=d,0===n&&f(Q));else b=k;b!==d?(93===g.charCodeAt(c)?(e=qa,c++):(e=d,0===n&&f(ra)),e!==d?a=b=b.join(""):(c=a,a=k)):(c=a,a=k)}else c=a,a=k;a!==d&&(a={op:"lookup",value:a});return a}var v=1<arguments.length?arguments[1]:{},d={},R={start:e},S=e,k=d,T="(",U={type:"literal",value:"(",description:'"("'},V=")",
W={type:"literal",value:")",description:'")"'},X="*",Y={type:"literal",value:"*",description:'"*"'},Z="/",$={type:"literal",value:"/",description:'"/"'},aa="+",ba={type:"literal",value:"+",description:'"+"'},F="-",G={type:"literal",value:"-",description:'"-"'},ca="d",da={type:"literal",value:"d",description:'"d"'},ea="w",fa={type:"literal",value:"w",description:'"w"'},K="..",ga={type:"literal",value:"..",description:'".."'},L=/^[ ]/,M={type:"class",value:"[ ]",description:"[ ]"},ia="f",ja={type:"literal",
value:"f",description:'"f"'},ka="r",la={type:"literal",value:"r",description:'"r"'},ma="c",na={type:"literal",value:"c",description:'"c"'},oa="[",pa={type:"literal",value:"[",description:'"["'},P=/^[a-zA-Z 0-9]/,Q={type:"class",value:"[a-zA-Z 0-9]",description:"[a-zA-Z 0-9]"},qa="]",ra={type:"literal",value:"]",description:'"]"'},ha={type:"other",description:"integer"},A=/^[0-9]/,B={type:"class",value:"[0-9]",description:"[0-9]"},c=0,x=0,C={line:1,column:1,seenCR:!1},z=0,D=[],n=0;if("startRule"in
v){if(!(v.startRule in R))throw Error("Can't start parsing from rule \""+v.startRule+'".');S=R[v.startRule]}v=S();if(v!==d&&c===g.length)return v;v!==d&&c<g.length&&f({type:"end",description:"end of input"});throw function(a,b,c){function d(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function e(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),f;for(f=0;f<a.length;f++)d[f]=a[f].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-
1]:d[0];f=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+f+" found."}var f=u(c),m=c<g.length?g.charAt(c):null;null!==b&&d(b);return new h(null!==a?a:e(b,m),b,m,c,f.line,f.column)}(null,D,z);}}}();
dice.eval=function(){function h(f){var e=[];e[f]=!0;for(f=0;f<e.length;f++)e[f]=!0;return e}function g(f){var e;e=(e=f.args)||[];e=e.map(g);return u[f.op].apply(f,e)}var u={"static":function(){var f=this.value;return function(){return f}},lookup:function(){var f=this.value;return function(e){return e[f]}},floor:function(f){return function(e){e=f(e);var m=new Number(Math.floor(e));m.op="floor";m.expression=e;return m}},ceil:function(f){return function(e){e=f(e);var m=new Number(Math.ceil(e));m.op=
"ceil";m.expression=e;return m}},round:function(f){return function(e){e=f(e);var m=new Number(Math.round(e));m.op="round";m.expression=e;return m}},d:function(f,e){return function(m){var g=f(m),l,r,t=h(g-1).map(function(){var f=e(m);l=f.min;r=f.max;return f}),p=t.reduce(function(e,f){return e+f},0),p=new Number(p);p.rolls=t;p.min=l;p.max=r;p.x=g;p.mode="d";return p}},w:function(f,e){return function(m){var g=f(m),l,r,t=h(g-1).map(function(){var f=e(m),g=0;l=e.min;r=e.max;if(e.min===e.max)return f;
for(;f===e.max;)g+=f,f=mimMax(m);return g}),p=t.reduce(function(e,f){return e+f},0),p=new Number(p);p.rolls=t;p.min=l;p.max=r;p.x=g;p.mode="w";return p}},random:function(f,e){return function(g){var h=Math.random(),l=e(g);g=f(g);h=Math.round((l-g)*h+g);h=new Number(h);h.min=g;h.max=l;return h}},"+":function(f,e){return function(g){var h=f(g);g=e(g);var l;l=new Number(h+g);l.op="+";l.rightSide=h;l.leftSide=g;return l}},"-":function(f,e){return function(g){var h=f(g);g=e(g);var l;l=new Number(h-g);l.op=
"-";l.rightSide=h;l.leftSide=g;return l}},"*":function(f,e){return function(g){var h=f(g);g=e(g);var l;l=new Number(h*g);l.op="*";l.rightSide=h;l.leftSide=g;return l}},"/":function(f,e){return function(g){var h=f(g);g=e(g);var l;l=new Number(h/g);l.op="/";l.rightSide=h;l.leftSide=g;return l}},paren_express:function(f){return function(e){e=f(e);outtots=new Number(e);outtots.op="paren_express";outtots.expression=e;return outtots}}};return{eval:function(f,e){e=e||{};return g(f)(e)},ops:u}}();
